<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# migrator

```go
import "github.com/brpaz/lib-go/storage/db/migrator"
```

```
if err != nil {
		return err
	}
```

// Run the migrations

```
if err := m.Up(ctx); err != nil {
	return err
}
```

## Index

- [Constants](<#constants>)
- [Variables](<#variables>)
- [type GooseMigrator](<#GooseMigrator>)
  - [func NewGooseMigrator\(opts ...GooseMigratorOpt\) \(\*GooseMigrator, error\)](<#NewGooseMigrator>)
  - [func \(m \*GooseMigrator\) Create\(\_ context.Context, name string\) error](<#GooseMigrator.Create>)
  - [func \(m \*GooseMigrator\) Down\(ctx context.Context\) error](<#GooseMigrator.Down>)
  - [func \(m \*GooseMigrator\) Reset\(ctx context.Context\) error](<#GooseMigrator.Reset>)
  - [func \(m \*GooseMigrator\) Up\(ctx context.Context\) error](<#GooseMigrator.Up>)
  - [func \(m \*GooseMigrator\) Validate\(\) error](<#GooseMigrator.Validate>)
- [type GooseMigratorOpt](<#GooseMigratorOpt>)
  - [func WithGooseAllowOutOfOrder\(allow bool\) GooseMigratorOpt](<#WithGooseAllowOutOfOrder>)
  - [func WithGooseDB\(db \*sql.DB\) GooseMigratorOpt](<#WithGooseDB>)
  - [func WithGooseDialect\(dialect string\) GooseMigratorOpt](<#WithGooseDialect>)
  - [func WithGooseMigrationsDir\(dir string\) GooseMigratorOpt](<#WithGooseMigrationsDir>)
  - [func WithGooseMigrationsFS\(fs embed.FS\) GooseMigratorOpt](<#WithGooseMigrationsFS>)
  - [func WithGooseMigrationsType\(t string\) GooseMigratorOpt](<#WithGooseMigrationsType>)
  - [func WithGooseSequencial\(sequencial bool\) GooseMigratorOpt](<#WithGooseSequencial>)
- [type Migrator](<#Migrator>)


## Constants

<a name="MigrationTypeGo"></a>

```go
const (
    MigrationTypeGo  = "go"
    MigrationTypeSQL = "sql"
)
```

## Variables

<a name="ErrDBNotSet"></a>

```go
var (
    ErrDBNotSet              = errors.New("a sql.DB connection is required")
    ErrMigrationsNotSet      = errors.New("migrations directory or filesystem is required")
    ErrInvalidMigrationsType = errors.New("invalid migrations type. must be either 'go' or 'sql'")
)
```

<a name="GooseMigrator"></a>
## type [GooseMigrator](<https://github.com/brpaz/lib-go/blob/main/storage/db/migrator/goose.go#L24-L45>)

GooseMigrator is a migrator that uses Goose under the hood.

```go
type GooseMigrator struct {
    // DB is the database connection to use for migrations.
    DB  *sql.DB

    // Dir is the directory containing migration files.
    MigrationsDir string

    // FS is the filesystem containing migration files.
    MigrationsFS embed.FS

    // MigrationsType is the type of migrations to run.
    MigrationsType string

    // Dialect is the database dialect to use for migrations.
    Dialect string

    // AllowOutOfOrder allows migrations
    AllowOutOfOrder bool

    // Sequntial defines to use sequential migrations instead of timestamped
    Sequencial bool
}
```

<a name="NewGooseMigrator"></a>
### func [NewGooseMigrator](<https://github.com/brpaz/lib-go/blob/main/storage/db/migrator/goose.go#L119>)

```go
func NewGooseMigrator(opts ...GooseMigratorOpt) (*GooseMigrator, error)
```

NewGooseMigrator creates a new GooseMigrator with the given options.

<a name="GooseMigrator.Create"></a>
### func \(\*GooseMigrator\) [Create](<https://github.com/brpaz/lib-go/blob/main/storage/db/migrator/goose.go#L162>)

```go
func (m *GooseMigrator) Create(_ context.Context, name string) error
```

Create creates a new migration file.

<a name="GooseMigrator.Down"></a>
### func \(\*GooseMigrator\) [Down](<https://github.com/brpaz/lib-go/blob/main/storage/db/migrator/goose.go#L150>)

```go
func (m *GooseMigrator) Down(ctx context.Context) error
```

Down rolls back the most recent migration.

<a name="GooseMigrator.Reset"></a>
### func \(\*GooseMigrator\) [Reset](<https://github.com/brpaz/lib-go/blob/main/storage/db/migrator/goose.go#L156>)

```go
func (m *GooseMigrator) Reset(ctx context.Context) error
```

Reset rolls back all migrations.

<a name="GooseMigrator.Up"></a>
### func \(\*GooseMigrator\) [Up](<https://github.com/brpaz/lib-go/blob/main/storage/db/migrator/goose.go#L137>)

```go
func (m *GooseMigrator) Up(ctx context.Context) error
```

Up runs all available migrations.

<a name="GooseMigrator.Validate"></a>
### func \(\*GooseMigrator\) [Validate](<https://github.com/brpaz/lib-go/blob/main/storage/db/migrator/goose.go#L47>)

```go
func (m *GooseMigrator) Validate() error
```



<a name="GooseMigratorOpt"></a>
## type [GooseMigratorOpt](<https://github.com/brpaz/lib-go/blob/main/storage/db/migrator/goose.go#L64>)

GooseMigratorOpt is a functional option for configuring a GooseMigrator.

```go
type GooseMigratorOpt func(*GooseMigrator)
```

<a name="WithGooseAllowOutOfOrder"></a>
### func [WithGooseAllowOutOfOrder](<https://github.com/brpaz/lib-go/blob/main/storage/db/migrator/goose.go#L104>)

```go
func WithGooseAllowOutOfOrder(allow bool) GooseMigratorOpt
```

WithGooseAllowOutOfOrder allows migrations to run out of order.

<a name="WithGooseDB"></a>
### func [WithGooseDB](<https://github.com/brpaz/lib-go/blob/main/storage/db/migrator/goose.go#L89>)

```go
func WithGooseDB(db *sql.DB) GooseMigratorOpt
```

WithGooseDB sets the database connection to use for migrations.

<a name="WithGooseDialect"></a>
### func [WithGooseDialect](<https://github.com/brpaz/lib-go/blob/main/storage/db/migrator/goose.go#L96>)

```go
func WithGooseDialect(dialect string) GooseMigratorOpt
```

WithGooseDialect sets the database dialect to use for migrations.

<a name="WithGooseMigrationsDir"></a>
### func [WithGooseMigrationsDir](<https://github.com/brpaz/lib-go/blob/main/storage/db/migrator/goose.go#L67>)

```go
func WithGooseMigrationsDir(dir string) GooseMigratorOpt
```

WithGooseMigrationsDir sets the directory containing migration files.

<a name="WithGooseMigrationsFS"></a>
### func [WithGooseMigrationsFS](<https://github.com/brpaz/lib-go/blob/main/storage/db/migrator/goose.go#L74>)

```go
func WithGooseMigrationsFS(fs embed.FS) GooseMigratorOpt
```

WithGooseMigrationsFS sets the filesystem containing migration files.

<a name="WithGooseMigrationsType"></a>
### func [WithGooseMigrationsType](<https://github.com/brpaz/lib-go/blob/main/storage/db/migrator/goose.go#L82>)

```go
func WithGooseMigrationsType(t string) GooseMigratorOpt
```

WithGooseMigrationsType sets the type of migrations to run.

<a name="WithGooseSequencial"></a>
### func [WithGooseSequencial](<https://github.com/brpaz/lib-go/blob/main/storage/db/migrator/goose.go#L111>)

```go
func WithGooseSequencial(sequencial bool) GooseMigratorOpt
```

WithGooseSequencial allows to use sequential migrations instead of timestamped

<a name="Migrator"></a>
## type [Migrator](<https://github.com/brpaz/lib-go/blob/main/storage/db/migrator/migrator.go#L8-L13>)

Migrator is an interface for managing database migrations.

```go
type Migrator interface {
    Up(ctx context.Context) error
    Down(ctx context.Context) error
    Reset(ctx context.Context) error
    Create(ctx context.Context, name string) error
}
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
